from IPython.display import display, HTML
html_advanced_hand_gallery = """

<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8">

<style>

body { font-family: 'Segoe UI', sans-serif; margin:0; background:#050505; color:white; overflow:hidden; text-align:center; }

#container { position:relative; width:900px; height:550px; margin:20px auto; border:8px solid #222; border-radius:20px; overflow:hidden; background:#000; }

.slide { position:absolute; top:0; left:0; width:100%; height:100%; background-size:cover; background-position:center; transition: transform 0.1s ease-out; }

#canvas-layer { position:absolute; top:0; left:0; width:100%; height:100%; z-index:5; pointer-events:none; }

button { padding:15px 40px; font-size:18px; cursor:pointer; background:#ff4757; color:white; border:none; border-radius:10px; margin-top:10px; }

</style>

</head>

<body>

 

<h2>ðŸ¤š Two-Hand Interactive Gallery</h2>

<p>Swipe left/right with both hands. Drag single hand. Pinch two hands to zoom.</p>

 

<div id="container">

  <div class="slide" id="current-img"></div>

  <canvas id="canvas-layer" width="900" height="550"></canvas>

  <video id="video-input" style="display:none;" autoplay playsinline></video>

</div>

<button id="start-btn">Activate Camera</button>

 

<script type="module">

import { GestureRecognizer, FilesetResolver } from "https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.3/+esm";

 

const video = document.getElementById('video-input');

const curDiv = document.getElementById('current-img');

const canvas = document.getElementById('canvas-layer');

const ctx = canvas.getContext('2d');

const startBtn = document.getElementById('start-btn');

 

let gestureRecognizer;

let imageList = [

'https://images.unsplash.com/photo-1451187580459-43490279c0fa?auto=format&fit=crop&w=900&q=80',

'https://images.unsplash.com/photo-1514565131-fce0801e5785?auto=format&fit=crop&w=900&q=80',

'https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?auto=format&fit=crop&w=900&q=80',

'https://images.unsplash.com/photo-1503023345310-bd7c1de61c7d?auto=format&fit=crop&w=900&q=80',

'https://images.unsplash.com/photo-1531177071273-1d9d14a847e7?auto=format&fit=crop&w=900&q=80',

'https://images.unsplash.com/photo-1526948128573-703ee1aeb6fa?auto=format&fit=crop&w=900&q=80',

'https://images.unsplash.com/photo-1499084732479-de2c02d45fc4?auto=format&fit=crop&w=900&q=80',

'https://images.unsplash.com/photo-1470770841072-f978cf4d019e?auto=format&fit=crop&w=900&q=80',

'https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=900&q=80',

'https://images.unsplash.com/photo-1516117172878-fd2c41f4a759?auto=format&fit=crop&w=900&q=80'

];

 

let currentIndex = 0;

let imgPosX = 0, imgPosY = 0;

let imgScale = 1;

let prevDistance = null;

let lastSwipeX = null;

let canSwap = true;

 

curDiv.style.backgroundImage = `url(${imageList[0]})`;

 

async function init() {

  const vision = await FilesetResolver.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.3/wasm");

  gestureRecognizer = await GestureRecognizer.createFromOptions(vision, {

    baseOptions: { modelAssetPath: "https://storage.googleapis.com/mediapipe-models/gesture_recognizer/gesture_recognizer/float16/1/gesture_recognizer.task", delegate:"GPU" },

    runningMode:"VIDEO",

    numHands:2

  });

 

  const stream = await navigator.mediaDevices.getUserMedia({ video:true });

  video.srcObject = stream;

  video.play();

  startBtn.style.display='none';

  render();

}

 

function updateImageTransform(){

  curDiv.style.transform = `translate(${imgPosX}px, ${imgPosY}px) scale(${imgScale})`;

}

 

function swapImage(direction){

  if(!canSwap) return;

  canSwap=false;

  currentIndex = direction==='next' ? (currentIndex+1)%imageList.length : (currentIndex-1+imageList.length)%imageList.length;

  curDiv.style.opacity='0';

  setTimeout(()=>{

    curDiv.style.backgroundImage = `url(${imageList[currentIndex]})`;

    imgScale=1;

    imgPosX=0;

    imgPosY=0;

    curDiv.style.opacity='1';

    setTimeout(()=>{canSwap=true;},500);

  },200);

}

 

function render(){

  ctx.clearRect(0,0,canvas.width,canvas.height);

  if(gestureRecognizer && video.readyState>=2){

    const results = gestureRecognizer.recognizeForVideo(video, Date.now());

    if(results.landmarks && results.landmarks.length>0){

      const hands = results.landmarks.slice(0,2);

      hands.forEach((hand,i)=>{

        const indexTip = hand[8];

        const x = (1 - indexTip.x)*canvas.width;

        const y = indexTip.y*canvas.height;

        ctx.beginPath();

        ctx.arc(x,y,12,0,Math.PI*2);

        ctx.fillStyle = i===0?"#00e5ff":"#ff4757";

        ctx.fill();

      });

 

      if(hands.length===2){

        const x1=(1-hands[0][8].x)*canvas.width;

        const x2=(1-hands[1][8].x)*canvas.width;

        const avgX=(x1+x2)/2;

        if(lastSwipeX!=null){

          if(avgX - lastSwipeX > 80) { swapImage('prev'); lastSwipeX=null; }

          if(lastSwipeX - avgX > 80) { swapImage('next'); lastSwipeX=null; }

        } else { lastSwipeX=avgX; }

 

        const h1=hands[0][8], h2=hands[1][8];

        const dx=h1.x - h2.x, dy=h1.y - h2.y;

        const distance=Math.sqrt(dx*dx+dy*dy);

        if(prevDistance!=null){

          imgScale *= distance/prevDistance;

          if(imgScale<0.5) imgScale=0.5;

          if(imgScale>3) imgScale=3;

        }

        prevDistance=distance;

 

        imgPosX=((1-h1.x)+(1-h2.x))/2*canvas.width - 450;

        imgPosY=(h1.y+h2.y)/2*canvas.height - 275;

      } else { prevDistance=null; }

 

      if(hands.length===1){

        const h=hands[0][8];

        imgPosX=(1-h.x)*canvas.width - 450;

        imgPosY=h.y*canvas.height - 275;

      }

 

      updateImageTransform();

    }

  }

  requestAnimationFrame(render);

}

 

startBtn.onclick=init;

</script>

</body>

</html>

"""

 

display(HTML(html_advanced_hand_gallery))
